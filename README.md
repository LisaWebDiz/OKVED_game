# Phone to OKVED Matcher

## Описание проекта

Проект принимает строку с российским мобильным номером в любом формате, нормализует её в формат `+79XXXXXXXXX` и ищет соответствующий код ОКВЭД по окончанию номера.  

Если совпадений нет, применяется резервная стратегия.  

Проект реализован с акцентом на:

- строгую нормализацию номеров,
- поиск **максимального совпадения** по окончанию номера,
- корректную обработку ошибок и невалидных номеров,
- структурированный и документированный код.

## Основные возможности

1. **Нормализация номера**
   - Преобразует номер в формат `+79XXXXXXXXX`.
   - Если номер невалидный — возвращает `False` и выводит сообщение об ошибке.

2. **Загрузка ОКВЭД**
   - Загружает `okved.json` по HTTPS с репозитория (файл обновляется ежедневно).

3. **Поиск ОКВЭД**
   - Находит все коды с максимальной длиной совпадения по окончанию номера.
   - Если совпадений нет — возвращает резервный код (по умолчанию `None`) и сообщение `"Совпадений не найдено"`.

4. **Вывод результатов**
   - Нормализованный номер
   - Найденный код ОКВЭД и его название
   - Длина совпадения


## Логика определения совпадения с ОКВЭД

После нормализации телефонного номера программа сравнивает его окончание с кодами ОКВЭД.
Совпадение определяется по максимальной длине суффикса (окончания строки).

Применяются следующие правила:
Всегда выбирается один ОКВЭД — тот, у которого совпадение самое длинное.
Даже если несколько кодов совпадают частично, выбирается максимально точное совпадение.

### Пример: при поиске 29.3  
**Результат будет:**   
"code": "29.3", "name": "Производство комплектующих и принадлежностей для автотранспортных средств",  

**При этом будут проигнорированы ОКВЭД:**  
"code": "07.29.3", "name": "Добыча и обогащение алюминийсодержащего сырья (бокситов и нефелин-апатитовых руд)"  
"code": "16.29.3", "name": "Изготовление изделий из дерева, пробки, соломки и материалов для плетения, корзиночных и плетеных изделий по индивидуальному заказу населения"   
"code": "22.29.3", "name": "Производство устройств пломбировочных из пластика"  
"code": "28.29.3", "name": "Производство промышленного, бытового и прочего оборудования для взвешивания и дозировки",  
"code": "47.29.3", "name": "Торговля розничная прочими пищевыми продуктами в специализированных магазинах",  
"code": "56.29.3", "name": "Деятельность по доставке продуктов питания учебным, спортивным и прочим учреждениям (по льготным ценам)"  
"code": "77.29.3", "name": "Прокат музыкальных инструментов"   
"code": "93.29.3", "name": "Организация обрядов (свадеб, юбилеев), в т.ч. музыкальное сопровождение"   
"code": "95.29.3", "name": "Ремонт игрушек и подобных им изделий"

Если совпадений нет вообще, возвращается { code: None, name: "Совпадений не найдено" }.

Резюме: всегда возвращается **один единственный** код ОКВЭД, дающий самое точное совпадение.


## Запуск проекта

### 1. Клонирование репозитория
```
git clone https://github.com/LisaWebDiz/OKVED_game.git
cd OKVED_game
```

### 2. Создание виртуального окружения (рекомендуется)
```
python -m venv venv
# Linux / macOS
source venv/bin/activate
# Windows
venv\Scripts\activate
```

### 3. Установка зависимостей
```
pip install -r requirements.txt
```
### 4. Быстрый запуск

После установки зависимостей можно выполнить приложение одной командой:
```
python -m src.main "8 (999) 5282512"
```

Программа выполнит действия:
- нормализует номер до формата +79XXXXXXXXX
- загрузит актуальный okved.json
- найдёт наилучшие совпадения по окончанию номера
- выведет найденный ОКВЭД и длину совпадения
- сообщит об ошибке, если номер невалидный

###  Примеры вывода:
```
python -m src.main "8 (999) 5282512"
```
Нормализованный номер: +79995282512

**--- Результаты поиска ---  
Код ОКВЭД: 28.25.12  
Название: Производство оборудования для кондиционирования воздуха  
Длина совпадения: 6**  
  
  

``` 
python -m src.main "+7(499) 5282512"
```
**Ошибка: невалидный номер**  


## Требования

- Python 3.10+
- requests (для загрузки JSON)
- pytest (для тестирования)


## Тестирование

- корректность нормализации номеров,
- поиск ОКВЭД по максимальному совпадению,
- резервную стратегию для номеров без совпадений,
- корректную обработку невалидных номеров.


## Документация и стандарты

- Стандарт документации: Google Docstring
- Все функции и классы снабжены docstring с описанием параметров и возвращаемых значений.
- Код оформлен согласно PEP8 (Python).


## Лицензия

Проект использует библиотеки с открытой лицензией MIT или эквивалентной.
Авторское решение — MIT License.